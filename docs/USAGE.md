# 使用文档

## 目录

- [安装教程](#安装教程)
- [基础使用](#基础使用)
- [高级功能](#高级功能)
- [常见问题](#常见问题)
- [故障排除](#故障排除)

---

## 安装教程

### 方法一：Tampermonkey脚本安装（推荐）

#### 1. 安装Tampermonkey浏览器扩展

**Chrome/Edge浏览器：**
1. 访问 [Chrome网上应用店](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
2. 点击"添加至Chrome"
3. 确认安装

**Firefox浏览器：**
1. 访问 [Firefox附加组件](https://addons.mozilla.org/firefox/addon/tampermonkey/)
2. 点击"添加到Firefox"
3. 确认安装

#### 2. 安装脚本

**方式A：直接安装（推荐）**
1. 点击 [安装链接](../src/bilibili_video_exporter.user.js)
2. Tampermonkey会自动识别并弹出安装页面
3. 点击"安装"按钮

**方式B：手动安装**
1. 点击浏览器工具栏的Tampermonkey图标
2. 选择"管理面板"
3. 点击左侧的"+"号（新建脚本）
4. 删除默认内容
5. 复制 `src/bilibili_video_exporter.user.js` 的全部内容
6. 粘贴到编辑器
7. 按 `Ctrl+S` 保存

#### 3. 验证安装

1. 访问任意B站UP主主页（如：https://space.bilibili.com/123456）
2. 点击"投稿"标签
3. 右侧应该出现 📥 图标
4. 控制台（F12）应该显示："B站视频列表导出工具已加载"

---

### 方法二：浏览器控制台使用

适合临时使用或不想安装扩展的用户。

#### 步骤：

1. **打开B站UP主投稿页面**
   - 访问UP主主页
   - 点击"投稿"标签

2. **打开开发者工具**
   - 按 `F12` 键
   - 或右键点击页面 → 选择"检查"

3. **切换到Console标签**
   - 点击顶部的"Console"标签

4. **运行脚本**
   - 打开 `src/bilibili_export_console.js` 文件
   - 复制全部内容
   - 粘贴到控制台
   - 按 `Enter` 键运行

5. **导出数据**
   - 脚本会自动开始提取视频信息
   - 等待提取完成
   - CSV文件会自动下载

---

## 基础使用

### 导出当前页面的视频

1. **访问UP主投稿页面**
   ```
   https://space.bilibili.com/[UID]/video
   ```

2. **等待视频加载**
   - 确保页面已完全加载
   - 可以看到视频列表

3. **触发导出**

   **方式1：点击按钮**
   - 鼠标移到右侧边缘
   - 📥 图标会展开显示"导出视频列表"
   - 点击按钮

   **方式2：使用快捷键**
   - 按 `Ctrl+Shift+E`
   - 立即触发导出

4. **等待导出完成**
   - 会弹出提示："成功导出 XX 个视频到CSV文件！"
   - CSV文件会自动下载到浏览器默认下载目录

### 导出所有视频（包括未加载的）

B站使用懒加载机制，默认只显示30个左右的视频。要导出所有视频：

1. **滚动加载更多**
   - 向下滚动页面
   - 等待新视频加载出来
   - 重复直到所有视频都加载完成

2. **确认加载完成**
   - 滚动到页面底部
   - 看到"没有更多了"或类似提示

3. **导出全部**
   - 点击导出按钮或按快捷键
   - 所有已加载的视频都会被导出

---

## 高级功能

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+Shift+E` | 触发导出 |

### 自定义导出字段

如果需要修改导出的字段，可以编辑脚本：

1. 打开Tampermonkey管理面板
2. 找到"B站视频列表导出工具"
3. 点击编辑
4. 找到这一行：
   ```javascript
   const headers = ['序号', '标题', 'BV号', '链接', '封面', '时长', '播放量', '发布时间'];
   ```
5. 修改字段名称或顺序
6. 保存脚本

### 批量导出多个UP主

1. 打开第一个UP主的投稿页面
2. 导出视频列表
3. 打开第二个UP主的投稿页面
4. 再次导出
5. 重复以上步骤

每个UP主的数据会保存为独立的CSV文件。

---

## 常见问题

### Q1: 为什么只导出了部分视频？

**A:** B站使用懒加载机制，需要滚动页面加载更多视频。

**解决方法：**
1. 向下滚动页面
2. 等待新视频加载
3. 滚动到底部确保全部加载
4. 再次点击导出

### Q2: 导出的CSV文件乱码怎么办？

**A:** 使用正确的方式打开CSV文件。

**解决方法：**
- **Excel 2016及以上：** 直接双击打开即可
- **Excel 2013及以下：**
  1. 打开Excel
  2. 点击"数据" → "从文本"
  3. 选择CSV文件
  4. 选择"UTF-8"编码
  5. 点击"完成"

### Q3: 点击导出按钮没有反应？

**A:** 可能是页面未完全加载或脚本冲突。

**解决方法：**
1. 刷新页面重试
2. 检查控制台是否有错误信息
3. 尝试使用快捷键 `Ctrl+Shift+E`
4. 禁用其他可能冲突的脚本

### Q4: 下载失败怎么办？

**A:** 脚本有备用方案。

**自动处理：**
- 下载失败时，CSV内容会自动复制到剪贴板
- 按照提示手动保存即可

**手动处理：**
1. 打开控制台（F12）
2. 找到输出的CSV内容
3. 复制内容
4. 新建文本文件
5. 粘贴内容
6. 保存为 `.csv` 文件

### Q5: 能否导出其他信息（如点赞数、评论数）？

**A:** 当前版本只能导出页面上显示的信息。

点赞数、评论数等信息需要调用B站API，可能会遇到：
- 需要登录验证
- 请求频率限制
- 反爬虫机制

如有需求，可以提Issue讨论。

---

## 故障排除

### 问题：脚本无法加载

**检查步骤：**
1. 确认Tampermonkey已安装并启用
2. 确认脚本已启用（Tampermonkey图标上的数字应该>0）
3. 刷新页面
4. 查看控制台是否有错误信息

### 问题：找不到导出按钮

**检查步骤：**
1. 确认在UP主的投稿页面（URL包含 `/video`）
2. 等待2秒让脚本初始化
3. 检查页面右侧是否有 📥 图标
4. 尝试鼠标移到右侧边缘

### 问题：导出的数据不完整

**可能原因：**
1. 视频未完全加载
2. B站页面结构变化
3. 网络问题

**解决方法：**
1. 滚动页面加载所有视频
2. 等待页面稳定后再导出
3. 如果持续出现问题，请提Issue反馈

### 问题：CSV文件无法打开

**检查步骤：**
1. 确认文件扩展名是 `.csv`
2. 尝试用记事本打开查看内容
3. 使用Excel的"从文本导入"功能
4. 确认文件编码为UTF-8

---

## 技术支持

如果遇到其他问题：

1. **查看控制台日志**
   - 按F12打开控制台
   - 查看是否有错误信息
   - 截图保存

2. **提交Issue**
   - 访问 [GitHub Issues](https://github.com/your-repo/issues)
   - 描述问题
   - 附上截图和错误信息

3. **常见错误代码**
   - `未找到视频列表` - 页面未加载或不在投稿页面
   - `未能提取到视频数据` - 页面结构可能已变化
   - `下载失败` - 浏览器安全策略限制

---

**更新日期：** 2026-01-02
**版本：** 1.0.0
